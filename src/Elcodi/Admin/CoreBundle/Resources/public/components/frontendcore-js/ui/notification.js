TinyCore.AMD.define("notification",[],function(){return{mediator:TinyCore.Toolbox.request("mediator"),sPathCss:oGlobalSettings.sPathCssUI+"?v="+oGlobalSettings.sHash,bMessageCreated:!1,oTimer:null,onStart:function(){var a,b,c=oTools.getDataModules("notification"),d=this;oTools.trackModule("JS_Libraries","call","notification"),oTools.loadCSS(this.sPathCss),$(c).each(function(){a=this,b=a.getAttribute("data-tc-event"),"load"==b?d.getAttributesAndExecute(a):$(this).on("click",function(a){a.preventDefault(),d.getAttributesAndExecute(this)})}),d.mediator.subscribe(["notification"],this.processResponse,this)},getAttributesAndExecute:function(a){var b=this,c=a.getAttribute("data-tc-type")?a.getAttribute("data-tc-type"):"ok",d=a.getAttribute("data-tc-text")?a.getAttribute("data-tc-text"):null;null!==d&&b.showMessage(c,d)},processResponse:function(a){var b=a.data.type?a.data.type:"ok",c=a.data.message?a.data.message:"Success";this.showMessage(b,c)},setMessageVisibile:function(a,b,c,d){a.className="mb-n msg-"+c,a.innerHTML=d,b.style.top="0px"},showMessage:function(a,b){var c=this;if(null!==c.oTimer&&clearTimeout(c.oTimer),this.bMessageCreated){var d=document.getElementById("notification-message"),e=document.getElementById("notification");"0px"===e.style.top.toString()?(e.style.top="-1000px",c.oTimer=setTimeout(function(){c.setMessageVisibile(d,e,a,b)},300)):c.setMessageVisibile(d,e,a,b)}else this.createMessage(a,b)},createMessage:function(a,b){this.bMessageCreated=!0;var c=document.createElement("p"),d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("a"),g=this;d.id="notification",d.style.display="none",e.className="box-background pa-n ma-n",f.href="#",f.className="icon-times",f.id="notification-close",c.id="notification-message",c.className="mb-n msg-"+a,c.innerHTML=b,e.appendChild(c),e.appendChild(f),d.appendChild(e),$("body").prepend(d),$("#notification-close").on("click",function(){document.getElementById("notification").style.top="-1000px"}),$("#notification").fadeIn("fast",function(){document.getElementById("notification").style.top="0px",g.oTimer=setTimeout(function(){document.getElementById("notification").style.top="-1000px"},5e3)})},onStop:function(){this.mediator=null,this.bMessageCreated=null,this.oTimer=null},onDestroy:function(){delete this.mediator,delete this.bMessageCreated,delete this.oTimer}}});